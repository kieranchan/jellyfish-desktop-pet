# å¼€å‘æŒ‡å—

## é¡¹ç›®æ¶æ„

### ç›®å½•ç»“æ„è¯´æ˜

```
src/
â”œâ”€â”€ main/           # ä¸»è¿›ç¨‹ï¼ˆNode.jsç¯å¢ƒï¼‰
â”‚   â”œâ”€â”€ index.js   # åº”ç”¨å…¥å£ï¼Œåˆå§‹åŒ–åº”ç”¨
â”‚   â”œâ”€â”€ window.js  # çª—å£ç®¡ç†ï¼Œå¤„ç†çª—å£åˆ›å»ºå’Œæ§åˆ¶
â”‚   â”œâ”€â”€ tray.js    # ç³»ç»Ÿæ‰˜ç›˜ï¼Œæä¾›æ‰˜ç›˜èœå•
â”‚   â””â”€â”€ config.js  # é…ç½®ç®¡ç†ï¼Œå…¨å±€é…ç½®
â”‚
â”œâ”€â”€ renderer/       # æ¸²æŸ“è¿›ç¨‹ï¼ˆæµè§ˆå™¨ç¯å¢ƒï¼‰
â”‚   â”œâ”€â”€ index.html # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ index.js   # æ¸²æŸ“è¿›ç¨‹å…¥å£
â”‚   â”œâ”€â”€ pet.js     # å® ç‰©çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ canvas.js  # Canvasæ¸²æŸ“å¼•æ“
â”‚   â”œâ”€â”€ behavior.js # AIè¡Œä¸ºç³»ç»Ÿ
â”‚   â””â”€â”€ interaction.js # ç”¨æˆ·äº¤äº’å¤„ç†
â”‚
â”œâ”€â”€ styles/         # æ ·å¼æ–‡ä»¶
â””â”€â”€ utils/          # å·¥å…·å‡½æ•°
```

## æ¨¡å—è¯´æ˜

### ä¸»è¿›ç¨‹æ¨¡å—

#### index.js - åº”ç”¨å…¥å£
- åˆ›å»º Electron åº”ç”¨å®ä¾‹
- åˆå§‹åŒ–çª—å£ç®¡ç†å™¨å’Œæ‰˜ç›˜ç®¡ç†å™¨
- æ³¨å†Œ IPC é€šä¿¡äº‹ä»¶
- å¤„ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸ

#### window.js - çª—å£ç®¡ç†
- åˆ›å»ºå’Œç®¡ç†ä¸»çª—å£
- æ§åˆ¶çª—å£ä½ç½®å’ŒçŠ¶æ€
- å¤„ç†é¼ æ ‡ç©¿é€
- è·å–å±å¹•å°ºå¯¸

#### tray.js - ç³»ç»Ÿæ‰˜ç›˜
- åˆ›å»ºç³»ç»Ÿæ‰˜ç›˜å›¾æ ‡
- æ„å»ºæ‰˜ç›˜èœå•
- å¤„ç†æ‰˜ç›˜äº‹ä»¶
- ä¸çª—å£ç®¡ç†å™¨äº¤äº’

#### config.js - é…ç½®ç®¡ç†
- å®šä¹‰åº”ç”¨é…ç½®
- çª—å£é…ç½®
- å® ç‰©é…ç½®
- AIè¡Œä¸ºé…ç½®

### æ¸²æŸ“è¿›ç¨‹æ¨¡å—

#### pet.js - å® ç‰©çŠ¶æ€ç®¡ç†
- ç®¡ç†å® ç‰©çŠ¶æ€ï¼ˆä½ç½®ã€è¡¨æƒ…ã€åŠ¨ç”»ï¼‰
- æ›´æ–°å® ç‰©ç‰©ç†çŠ¶æ€
- å¤„ç†ç›®æ ‡ç§»åŠ¨
- ç¢°æ’æ£€æµ‹

#### canvas.js - Canvasæ¸²æŸ“å¼•æ“
- Canvasåˆå§‹åŒ–å’Œé…ç½®
- åƒç´ é£æ ¼æ¸²æŸ“
- ç»˜åˆ¶æ°´æ¯èº«ä½“å’Œè§¦é¡»
- åŠ¨ç”»å¸§æ¸²æŸ“

#### behavior.js - AIè¡Œä¸ºç³»ç»Ÿ
- éšæœºç§»åŠ¨ç®—æ³•
- éšæœºåŠ¨ä½œè¡¨æ¼”
- å¯¹è¯æ°”æ³¡æ˜¾ç¤º
- è¡Œä¸ºè°ƒåº¦ç³»ç»Ÿ

#### interaction.js - ç”¨æˆ·äº¤äº’
- é¼ æ ‡æ‹–æ‹½å¤„ç†
- ç‚¹å‡»åé¦ˆ
- å³é”®èœå•
- IPCé€šä¿¡

## å¼€å‘æµç¨‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼å¯åŠ¨
npm run dev
```

### 2. æ·»åŠ æ–°åŠŸèƒ½

#### æ·»åŠ æ–°çš„AIè¡Œä¸º

1. åœ¨ `behavior.js` ä¸­æ·»åŠ æ–°æ–¹æ³•ï¼š

```javascript
performNewAction() {
    console.log('ğŸ­ æ‰§è¡Œæ–°åŠ¨ä½œ');
    // å®ç°ä½ çš„é€»è¾‘
}
```

2. åœ¨ `randomAction()` ä¸­æ·»åŠ åˆ°åŠ¨ä½œåˆ—è¡¨ï¼š

```javascript
const actions = ['blink', 'jump', 'spin', 'shake', 'newAction'];
```

#### æ·»åŠ æ–°çš„è¡¨æƒ…

1. åœ¨ `canvas.js` çš„ `getJellyfishPixels()` ä¸­æ·»åŠ ï¼š

```javascript
case 'newExpression':
    eyes = [[24, 28], [28, 28], [36, 28], [40, 28]];
    break;
```

2. åœ¨ `behavior.js` ä¸­æ·»åŠ å¯¹åº”å¯¹è¯ï¼š

```javascript
this.speeches = {
    // ...existing
    newExpression: ['æ–°è¡¨æƒ…å¯¹è¯1', 'æ–°è¡¨æƒ…å¯¹è¯2']
};
```

#### æ·»åŠ å³é”®èœå•é¡¹

1. åœ¨ `index.html` ä¸­æ·»åŠ èœå•é¡¹ï¼š

```html
<div class="menu-item" data-action="new-action">
    ğŸ¨ æ–°åŠŸèƒ½
</div>
```

2. åœ¨ `interaction.js` ä¸­å¤„ç†äº‹ä»¶ï¼š

```javascript
case 'new-action':
    // å¤„ç†é€»è¾‘
    break;
```

### 3. IPCé€šä¿¡

#### ä»æ¸²æŸ“è¿›ç¨‹å‘é€åˆ°ä¸»è¿›ç¨‹

```javascript
// å‘é€æ¶ˆæ¯
ipcRenderer.send('event-name', arg1, arg2);

// åŒæ­¥è·å–è¿”å›å€¼
const result = ipcRenderer.sendSync('event-name');

// å¼‚æ­¥è·å–è¿”å›å€¼
const result = await ipcRenderer.invoke('event-name');
```

#### ä»ä¸»è¿›ç¨‹å‘é€åˆ°æ¸²æŸ“è¿›ç¨‹

```javascript
// åœ¨ä¸»è¿›ç¨‹ä¸­
mainWindow.webContents.send('event-name', data);

// åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­ç›‘å¬
ipcRenderer.on('event-name', (event, data) => {
    // å¤„ç†æ•°æ®
});
```

### 4. è°ƒè¯•æŠ€å·§

#### å¼€å¯å¼€å‘è€…å·¥å…·

```bash
npm run dev
```

#### æŸ¥çœ‹å® ç‰©çŠ¶æ€

åœ¨å¼€å‘è€…æ§åˆ¶å°ä¸­ï¼š

```javascript
// è®¿é—®åº”ç”¨å®ä¾‹
window.petApp

// æŸ¥çœ‹å® ç‰©çŠ¶æ€
window.petApp.pet.state

// æ‰‹åŠ¨è§¦å‘è¡Œä¸º
window.petApp.behavior.speak('happy')
window.petApp.pet.setExpression('angry')
```

#### æ—¥å¿—è¾“å‡º

```javascript
// åœ¨ä¸»è¿›ç¨‹
console.log('[Main]', data);

// åœ¨æ¸²æŸ“è¿›ç¨‹
console.log('[Renderer]', data);
```

## æ€§èƒ½ä¼˜åŒ–

### Canvasæ¸²æŸ“ä¼˜åŒ–

1. é¿å…åœ¨æ¸²æŸ“å¾ªç¯ä¸­åˆ›å»ºæ–°å¯¹è±¡
2. ä½¿ç”¨ç¦»å±Canvasé¢„æ¸²æŸ“
3. é™åˆ¶é‡ç»˜åŒºåŸŸ

### å†…å­˜ç®¡ç†

1. åŠæ—¶æ¸…ç†å®šæ—¶å™¨
2. ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
3. é¿å…å†…å­˜æ³„æ¼

### åŠ¨ç”»ä¼˜åŒ–

1. ä½¿ç”¨ `requestAnimationFrame`
2. é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€
3. å‡å°‘DOMæ“ä½œ

## æ‰“åŒ…å‘å¸ƒ

### æ„å»ºé…ç½®

ç¼–è¾‘ `package.json` ä¸­çš„ `build` å­—æ®µï¼š

```json
{
  "build": {
    "appId": "com.yourname.jellyfishpet",
    "productName": "æ°´æ¯æ¡Œå® ",
    "files": [
      "src/**/*",
      "assets/**/*"
    ]
  }
}
```

### æ‰“åŒ…å‘½ä»¤

```bash
# Windows
npm run build:win

# macOS
npm run build:mac

# Linux
npm run build:linux
```

## æµ‹è¯•

### å•å…ƒæµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰

```bash
npm test
```

### æ‰‹åŠ¨æµ‹è¯•æ¸…å•

- [ ] æ‹–æ‹½ç§»åŠ¨
- [ ] ç‚¹å‡»åé¦ˆ
- [ ] å³é”®èœå•
- [ ] AIè¡Œä¸º
- [ ] è¡¨æƒ…åˆ‡æ¢
- [ ] ç³»ç»Ÿæ‰˜ç›˜
- [ ] çª—å£ç½®é¡¶
- [ ] è·¨å±å¹•ç§»åŠ¨

## è´¡çŒ®è§„èŒƒ

### ä»£ç è§„èŒƒ

1. ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å
2. æ·»åŠ é€‚å½“çš„æ³¨é‡Š
3. éµå¾ªç°æœ‰ä»£ç é£æ ¼
4. æ¯ä¸ªå‡½æ•°ä¿æŒå•ä¸€èŒè´£

### æäº¤è§„èŒƒ

```
feat: æ·»åŠ æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ›´æ–°æ–‡æ¡£
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æ·»åŠ æµ‹è¯•
chore: æ„å»º/å·¥å…·é“¾æ›´æ–°
```

### Pull Request

1. åŸºäº `master` åˆ›å»ºåˆ†æ”¯
2. å®ŒæˆåŠŸèƒ½å¼€å‘
3. æäº¤å‰è¿è¡Œæµ‹è¯•
4. ç¼–å†™æ¸…æ™°çš„PRæè¿°
5. ç­‰å¾…ä»£ç å®¡æŸ¥

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•ä¿®æ”¹å® ç‰©çš„åˆå§‹ä½ç½®ï¼Ÿ
A: åœ¨ `config.js` ä¸­ä¿®æ”¹ `pet.defaultPosition`

### Q: å¦‚ä½•ç¦ç”¨ç³»ç»Ÿæ‰˜ç›˜ï¼Ÿ
A: åœ¨ `config.js` ä¸­è®¾ç½® `enableTray: false`

### Q: å¦‚ä½•æ·»åŠ æ–°çš„é…ç½®é¡¹ï¼Ÿ
A: åœ¨ `config.js` ä¸­æ·»åŠ ï¼Œç„¶åé€šè¿‡ `ipcRenderer.invoke('get-config')` è·å–

### Q: å¦‚ä½•å®ç°æŒä¹…åŒ–å­˜å‚¨ï¼Ÿ
A: ä½¿ç”¨ `src/utils/storage.js` æˆ–é›†æˆ `electron-store`

## ç›¸å…³èµ„æº

- [Electron å®˜æ–¹æ–‡æ¡£](https://www.electronjs.org/docs)
- [Canvas API æ–‡æ¡£](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API)
- [Node.js æ–‡æ¡£](https://nodejs.org/docs)
